# DB 9주차-2

Ch6. ER모델 (2)

2)
저번 시간에는 ER모델에 대한 기본적인 내용, ER다이어그램을 배웠다.

이번 시간에는 ER모델에서 Primary key를 어떻게 추출할 것인가를 중심으로.

또, ER모델은 relational model로 바꿀 수 있겠다. 그러한 내용도 배운다.

entity set, relationship set 에서의 primary key는 어떻게 설정할 수 있는지.

attribute의 중복을 어떻게 최소화 시킬 수 있는지.

3)

4)
Primary key
릴레이션 상에 튜플을 구분짓게 해줄 수 있는 요소

entity set의 프라이머리키는 릴레이셔널 데이터 모델에서의 프라이머리키와 유사

5)
entity set 을 어떻게 특정지을 수 있을까
relationship set 을 어떻게 특정지을수 있을까

새로 배울 개념, weak entity set.
weak entity set 을 어떻게 특정지을 수 있을가.

6)
entity set에서의 프라이머리키

개별적인 entity들은 다 구분이 가능하다.
데이터베이스 관점에서 엔티티들을 구분한다는 것 -> 어트리뷰트를 통해서 구분이 가능해야한다는 뜻.
즉, 어트리뷰트를 통해서 엔티티를 유일하게 식별가능하다.
즉, 한 엔티티 셋 내에서 모든 어트리뷰트가 같은 엔틴티가 2개이상 존재하면 안된다.

릴레이션에서의 프라이머리키 개념과 동일하다
엔티티셋 -> 릴레이션
엔티티 -> 각 튜플 => 동일한 튜플이 존재하면 안되니까.

엔티티셋에서의 key는 엔티티들을 구분할 수 있는 어트리뷰트의 집합으로 사용이 되고,
릴레이셔널 스키마에서의 key와 동일한 개념이겠다.

7)
릴레이션 셋에서의 프라이머키리를 어떻게 구하느냐.

릴레이션 셋에서도 릴레이션을 구분지을 수 있는 프라이머리키가 필요하다

R : 릴레이션셋
그 셋 내에 E1, E2..이라는 엔티티 셋들이 연결되어있다.

(?)합집합으로 표현이가능하다.

릴레이션십 셋 에서도 어트리뷰트가 존재한다.

(?)

8)
여기서 생기는 문제

릴레이션십에서는 여러가지 종류의 릴레이션십이 존재하다.
각각의 관계마다 프라이머리키를 만드는 방법이 다르다.

매니투매니 : 각각의 엔티티의 프라이머리키의 합집합이 프라이머리키로 사용
매니투원, 원투매니 : 매니 쪽의 프라이머리키를 프라이머리키로 사용
원투원 : 엔티티가 1:1로 매칭되는 경우 -> ex) A과 B가 1:1로 매칭 -> A 또는 B의 프라이머리키를 그대로 사용해도 되겠다.

9)
Weak entity set 이라는 개념

설명위해 section, course 엔티티를 고려해보자.
![DB 9주차-2](images/DB%209주차-2.png)

section : 분반정보
course : 과목정보

이 때 sec_course라는 릴레이션쉽을 만들었다고 해보자.
-> 정보가 중복이되었다고도 볼 수 있다.

…

해결방안?
sec_course라는 관계를 아예 만들지 않는다.
-> 근데 위와 같이 해버리면 ER다이어그램을 통해 가시적으로 표현할 수 가 없게된다..

10)
또다른 해결방안?
section에서 course_id를 지워버린다
-> 근데 이렇게 되면 튜플을 구분할수없게 되버린다.

그럼 어떻게 해결해야하나.
sec_course라고 하는 릴레이션쉽은 그대로두고, course_id를 지우고,
섹션의 엔티티의 정보들을 유니크하게 식별할 수 있게끔 정보를 추가해준다.

— 아직까지 이해가 잘안가지만, 뒤에서 예를 보면서 이해해보자.—

11)
weak entity set
앞서 본 문제를 해결할 수 있는 방안으로 등장함.
정의 : 프라이머리키를 형성하기 위해서 충분한 어튜리부트를 가지고 있지 않는 엔티티 셋을 칭함.
-> 다른엔티티에 도움을 받아야함 ->특별한 엔티티에 의존하게되는데, 그 의존하게되는 엔티티를 identifying entity라고 한다.

 identifying entity 어트리뷰트중에서 weak entity set을 구별토록 해주는 어트리뷰트를 discriminator attributes라고 한다.

strong entity set
자기가 가지고 있는 어트리뷰트만으로도 자기자신을 식별할 수 있는 엔티티 셋.

12)
위크 엔티티 같은 경우는 무조건 identifying entity가 존재해야한다.
위크 엔티티 셋은  identifying entity 셋에 종속관계에 있다.
이 때 identifying entity 셋은 위크 엔티티 셋을 소유하고 있다고하고,
그 둘의 관계를 identifying relationship이라고 한다.

13)
위크 엔티티셋도 ER다이어그램으로 표현가능하다.
엔티티 사각형 테두리를 2줄로. 겹선.
릴레이션십도 겹선.
identifying entity에서의 discriminator attributes 는 밑줄.

Q. 여기서 화살표는 무엇을 의미하나?
화살표는, 엔티티에서 one을 의미했는데,
identifying entity으로 들어가는 선은 화살표로 무조건 표현해야한다. 왜 one이어야 하나?
course가 one이어야만, section을 유니크하게 식별할 수 있다.
course쪽이 many이면 section 엔티티를 유니크하게 식별할 수 없다.

15)
Redundant attributes

여기서는 student, department 를 예로 들자.
stu_dept라는 릴레이션쉽을 만들자.

사실 stu_dept은 굳이 필요하지 않다.

student의 정보만으로, student, department 두 개의 관계를 표현가능하기때문.
student내에 dept_name이라는 어트리뷰트가 있기때문.

그러나 student에 dept_name이 없다면 다음과같은 릴레이션쉽이 필요하다.

16)

17)
ER다이어그램을 그리는 목적은 릴레이션 스키마를 설계하기 위해 필요하다.

ER다이어그램을 먼저 그리고, 그 이후에 릴레이션 스키마를 설계하는 작업을 하게 된다.

18)
ER다이어그램에서는 엔티티셋, 릴레이션쉽셋이 존재하고 
이 두 개를 다 릴레이셔널 스키마로 바꿀 수 있어야한다.

엔티티셋과 릴레이션셋은 자기 자신의 이름을 갖는 고유 스키마로 만들 수 있다.

각 스키마는 어트리뷰트를 갖고 있다.

19)
스트롱 엔티티셋 을 변환

자기 자신이 갖는 어트리뷰를 가지고 그대로 스키마로

위크 엔티티셋은,
위크 엔티티셋이 갖고있는 어튜리뷰트 만으로는 스키마를 구성할 수 없음
-> 아이텐티파잉 엔티티셋이 가지고 있는 프라이머리키를 가져와서 스미카를 구성.

20)
composite 어트리뷰트를 어떻게 스키마로 바꾸는지.

composite 어트리뷰트 : 나누어질 수 있는 어트리뷰트

-> 쪼개지는 걸 어트리뷰트로 사용.
name이 first_name, last_name으로 쪼개질 수 있다면
first_name, last_name을 그냥 어트리뷰트으로.

멀티밸류드 어트리뷰트는 어떻게 스키마로
multivalued 어트리뷰트 : 여러개의 값을 가질 수 있는 어트리뷰트.
-> 일단 스키마에서 제외가된다.
그럼 어떻게 처리?

21)
새로운 스키마로 분리해서 표현

예시.

22)
릴레이션십 셋을 스키마로 바꾸는 방법

릴레이션쉽 셋에서 어트리뷰트는 엔티티의 프라이머키의 집합으로 구성될 수 있었다.

매니투매니 : 프라이머리키는 -> 두 엔티티의 프라이머키의 집합으로

23)
예시.

24)
매니투원, 원투매니

매니 쪽의 프라이머키가 곧 프라이머키가 된다.

25)
사실상 릴레이션쉽셋에느느 새로운 스키마의 도입이 필요없을 수 있다.
many측의 엔티티 셋에 one측의 프라이머리키 어트리뷰트를 추가시켜주면 되므로.

26)
원투원.

관계 자체가 유니크한 관계라서, 둘중 하나의 프라이머키를 사용해도 프라이머키로써 무방하다.

27)
위크엔티티셋과 스트롱엔티티셋에서의 릴레이션십

스키마가 사실상 중복이 되기 때문에,
이 때 sec_course라고하는 릴레이션쉽 셋은 스키마가 필요가없,,다 . 그냥 가시적인 관계를 위해 ER다이어그램에 있을뿐.

