# DB 10주차-2

ER다이어그램 그리는 방법 pdf 참조.

7장. Nomalization

좋은 RDB 설계란
불필요한 중복이 없어야 한다.
null값을 최소화시켜야 한다.

이떻게 이렇게 만들수 있는지에 대해서 배운다.

2)
이번 시간의 목표
RDB를 어떻게 잘 디자인 할 것인가.
그때 배우는 이론들
Functional Dependency (FD)
Boyce-Codd Normal From(BCNF)
Third Normal Form (3NF)

4)
어떤 Relation schema가 좋은 디자인인지.

5)
예시로
instructor과 department를 내추럴 조인해서 새로운 릴레이션을 만들었다고 가정해보자.
-> 새로 생성된 릴레이션은, 불필요한 정보들이 중복되고 있으므로 좋다고 할 수 없다.
또 널밸류가 쓰일경우 널값을 최소화 시킬 수 없다.
또 어떤값을 수정한다고 했을 때 일관성을 보장할 수 가 없다.

6)
그러나 합친다고 해서 꼭 나쁜건아니다.
다음 경우는 꼭 나쁜 경우라고 보기는 어렵다

7)
따라서 앞의 합쳐놓은 릴레이션인 in_dep 릴레이션을 instructor와 department로 쪼개줄 필요가 있다.
릴레이션을 나누는 것을 Decomposition이라고 한다.

막 분해시키면 안된다.
잘못된 분해는 정보를 손실시킬 수 있다.
잘못된 분해로 릴레이션을 다시 합쳤을 때 정보가 손실될 수 있다. -> lossy decomposition

8)
employ 예제에서 employ1와 2로 나누고,
다시 내추럴 조인했을 때 동명이인으로 인해 부정확한 정보들이 발생한다.

9)
R을 R1, R2로 분해했을 때

lossless decomposition : 비손실 분해
R1과 R2를 내추럴 조인했을 때 원래 R이 나오는경우

만약 내추럴조인한 릴레이션의 스키마가, 원래 릴레이션보다 더 크면 lossy decomposition(손실분해)이다.

10)
lossless decomposition 예제.

11)
normalization.
어떻게 하면 좋은 릴레이션을 설계할 수 있을지.
lossless decomposition을 하는 방법.

R이 좋은 형태가 아닐경우, R을 분해해주어야한다.
분해는 lossless decomposition이 되어야한다.

12)
FD를 사용한 분해방법.

13)
Functional Dependencies

실세계의 데이터들은 여러 제약조건이 존재하게된다.
예) 대학교 정보
-학생과 교수는 유니크한 ID를 가지고 있어야한다.
-학생과 교수는 하나의 이름을 가지고 있어야한다. (이 DB의 규칙인거고.. 동명이인이 있을수도 있고 등등)
-학생과 교수는 하나의 학과를 가지고 있다.  (역시 여기서만의 규칙)
-각각 학과가 갖는 예산과 빌딩이 있다.

등 과같은 제약조건이 있다. 현실세계에서.

legal instance
실세계의 데이터에 적합한 인스턴스.
데이터베이스에서 모든 릴레이션 상의 인스턴스가 legal instance 일 경우 데이터베이스의 인스턴스가 적합하다고표현

14)
FD(Functional Dependencies)
일종의 제약조건.
legal relation에 존재하는 제약조건. 
특정한 어튜리브트 집합의 값이 다른 어튜리뷰트집합의 값을 유니크하게 구분해줄 수 있을 때 그런 constraints를 FD라고 한다.

key의 개념과 비슷하다고 생각.
키는 튜플을 유니크하게 식별시켜주는 어트리뷰트의 집합 이었다.

15)
FD 표현
R : 릴레이션 스키마
알파, 베타 : 어트리뷰트의 집합
![DB 10주차-2](images/DB%2010주차-2.png)

알파 -> 베타 일때 릴레이션이 보존된다.
즉 알파값에 의해서 베타값도 유일하게 식별이 가능한 경우,
베타가 알파에 functional dependency하다 라고 말한다.

키에 대해서는,
![DB 10주차-2-1](images/DB%2010주차-2-1.png)

Key 어트리뷰트로  튜플을 구분했다면

FD에서는
![DB 10주차-2-2](images/DB%2010주차-2-2.png)

특정 어트리뷰트로 다른 어트리뷰트를 구분하는 관계

B->A는 FD하지만,
A->B는 FD하다고 할 수 없다.

hold하다 = FD하다 = 릴레이션을 보존하다.

16)
예시

17)
Closure
여러 FD 관계가 존재하고, 그 집합을 F라고 표현하면
각 F들을 통해서 유추할 수 있는 FD관계를 Closure이라고 한다.
예) A->B이고 B->C일 때, A->C 임을 유추할 수 있을 때 클로져라고한다.

그렇게 F를 통해 유추할 수 있는 집합들을 F+라고 한다. 즉 클로져의 집합

18)
키와 FD의 관계

K가 슈퍼키이고 릴레이션 R에 대해 K->R이라고 표현할 수 있다. 즉 FD관계
![DB 10주차-2-3](images/DB%2010주차-2-3.png)

또,
![DB 10주차-2-4](images/DB%2010주차-2-4.png)

이게 중요

따라서 FD는 슈퍼키에서 구분할 수 없는 릴레이션상에서의 constraint를 표현할 수 있는 방법이다.

…

19)
FD를 언제사용하냐

1. 주어진 FD를 통해서 relaiton이 legal한지 아닌지를 검사할 때
-> 적합하하다고 할 때, 릴레이션 r이 F를 만족한다고 표현
2. legal 릴레이션에 대해 constraints를 구체적으로 제시하는 역할
-> 릴레이션 스키마 R이 F를 만족한다고하면 F는 R을 홀드한다고 표현.

아래의 예시처럼 우연히 FD가 만족할 수 있는데, 이런 우연하게 성립하는 FD는 배제시켜야한다.
예시에서는 지금 당장에는 동명이인이 없어서 만족하지만, 나중에 생길수도 있으므로

20)
따라서 앞처럼 불확실한 FD가 아닌 확실한 FD를 Trivial FD라고 한다.
언제?
![DB 10주차-2-5](images/DB%2010주차-2-5.png)

이럴 때.

21)
lossless Decomposition을 FD로 표현하는 방법

22)
예시

…

23)
Dependency Preservation

분해가 잘 되었는지 안되었는지.

뒤(BCNF)에서 더 자세히 배울것.

24)
예제
역시 뒤에서 더 자세히

